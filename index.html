<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#14b8a6">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Ruang Madrasah</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="css/output.css"> <link rel="stylesheet" href="css/style.css">
    <style>
    @media (min-width: 768px) {
        #menu-lainnya-mobile {
        display: none !important;
        }
    }
    </style>
    <meta name="description" content="Jurnal Aktivitas Belajar">
    <script>
      // Skrip ini berjalan sangat cepat sebelum halaman di-render
      // untuk mencegah kedipan layar login.
      if (sessionStorage.getItem('loggedInRole')) {
        document.write('<style>#login-view { display: none; } #app { display: block; }<\/style>');
      }
    </script>
    
    <link rel="apple-touch-icon" href="https://placehold.co/192x192/14b8a6/FFFFFF?text=JB">

    <link href="css/output.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lateef:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Scheherazade+New:wght@400;700&display=swap" rel="stylesheet">
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body class="antialiased">
    <div id="login-view" class="flex flex-col items-center justify-center min-h-screen p-4 bg-slate-50">
        <div class="w-full max-w-sm">
            <div class="text-center mb-10">
                <h1 class="text-3xl sm:text-5xl font-bold text-teal-600">Ruang Madrasah</h1>
                <p class="text-base text-slate-500 mt-2">Jurnal Aktivitas Belajar</p>
            </div>
            <div class="card p-6 sm:p-8">
                <h2 class="text-xl font-semibold text-center text-slate-700 mb-6">Login</h2>
                <form id="login-form">
                    <div class="mb-4">
                        <label for="username" class="block text-sm font-medium text-slate-700 mb-1">Email</label>
                        <input type="text" id="username" class="form-input" required autocomplete="username">
                    </div>
                    <div class="mb-6">
                        <label for="password" class="block text-sm font-medium text-slate-700 mb-1">Password</label>
                        <div class="relative">
                            <input type="password" id="password" class="form-input pr-10" required autocomplete="current-password">
                            <button type="button" id="toggle-password" class="absolute inset-y-0 right-0 flex items-center px-3 text-slate-400 hover:text-slate-600 focus:outline-none">
                                <svg id="eye-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                                <svg id="eye-off-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 hidden"><path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"></path><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"></path><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"></path><line x1="2" y1="2" x2="22" y2="22"></line></svg>
                            </button>
                        </div>
                    </div>
                    <p id="login-error" class="text-sm text-red-500 text-center mb-4 hidden"></p>
                    <button type="submit" class="btn btn-primary w-full">Masuk</button>
                </form>
            </div>
        </div>
    </div>
    <div id="app" class="hidden">
         <nav id="sidebar-nav">
            <h1 class="text-3xl font-bold text-teal-600 px-2 mb-6">Ruang Madrasah</h1>
            
            <div class="space-y-2">
                <a href="#" data-page="ringkasan" class="sidebar-link active">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
                    <span>Dashboard</span>
                </a>
                <a href="#" data-page="jurnal" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                    <span>Jurnal</span>
                </a>
                <a href="#" data-page="daftar_hadir" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="m9 12 2 2 4-4"></path></svg>
                    <span>Daftar Hadir</span>
                </a>
                 <a href="#" data-page="materi_belajar" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20v2H6.5A2.5 2.5 0 0 1 4 19.5z"/><path d="M4 5.5A2.5 2.5 0 0 1 6.5 3H20v2H6.5A2.5 2.5 0 0 1 4 5.5zM4 12.5A2.5 2.5 0 0 1 6.5 10H20v2H6.5A2.5 2.5 0 0 1 4 12.5z"/></svg>
                    <span>Materi Belajar</span>
                </a>
                <a href="#" data-page="uji_kompetensi" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                    <span>Uji Kompetensi</span>
                </a>
                <a href="#" data-page="analisis_soal" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.21 15.89A10 10 0 1 1 8.11 2.98"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></svg>
                    <span>Analisis Butir Soal</span>
                </a>
                <a href="#" data-page="daya_serap" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 11 12 14 22 4"></polyline><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></svg>
                    <span>Daya Serap</span>
                </a>
                <button id="toggle-lainnya-menu" class="sidebar-link w-full flex justify-between items-center">
                    <span class="whitespace-nowrap">Menu Lainnya</span>
                    
                    <svg id="lainnya-chevron" class="w-4 h-4 transition-transform" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>

                <div id="sidebar-menu-lainnya" class="hidden space-y-2 pl-4">
                <a href="#" data-page="pengayaan" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>
                    <span>Pengayaan</span>
                </a>
                
                <a href="#" data-page="manajemen_akun" class="sidebar-link hidden" data-role="admin_lembaga">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    <span>Manajemen Akun</span>
                </a>
                <a href="#" data-page="kelas" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"></path><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"></path><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"></path><path d="M10 6h4"></path><path d="M10 10h4"></path><path d="M10 14h4"></path><path d="M10 18h4"></path></svg>
                    <span>Manajemen Kelas</span>
                </a>
                 <a href="#" data-page="profil" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                    <span>Profil</span>
                </a>
                 <a href="#" data-page="pengaturan" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
                    <span>Pengaturan</span>
                </a>
                <a href="#" data-page="tentang" class="sidebar-link">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                    <span>Tentang</span>
                </a>
                <a href="#" id="admin-logout-sidebar" class="sidebar-link hidden" data-role="admin_lembaga">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
                <span>Keluar</span>
                </a>
            </div>
        </nav>
        
        <main id="main-content-view" class="min-h-screen p-4 sm:p-6 md:p-8 pb-36 md:pb-8 md:ml-64 bg-slate-50">
            <header class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-8">
                <div class="flex items-center space-x-4">
                    <button id="home-btn" class="btn btn-secondary hidden">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                    </button>
                    <h1 id="page-title" class="text-2xl sm:text-3xl font-bold text-slate-800"></h1>
                    
                </div>
                <div id="header-actions" class="w-full sm:w-auto">
                    </div>
            </header>
            
            <div id="loader" class="text-center py-10 flex justify-center items-center text-teal-500">
                <div class="spinner w-8 h-8"></div>
            </div>

            <div id="page-content">
                <div id="profil-page" class="page">
                    <div class="max-w-3xl mx-auto space-y-8">
                        <div class="card p-6">
                            <h2 class="text-xl font-semibold text-slate-800 mb-6"></h2>
                            <form id="profile-form" class="space-y-4">
                                <div class="flex flex-col items-center space-y-4">
                                    <div class="relative">
                                        <img id="profile-picture-preview" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" alt="Foto Profil" class="w-32 h-32 rounded-full object-cover border-4 border-slate-200 cursor-pointer hover:opacity-90 transition-opacity">
                                        <label for="profile-picture-input" class="absolute bottom-0 right-0 bg-teal-600 text-white rounded-full p-2 cursor-pointer hover:bg-teal-700 transition-colors">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><path d="M12 20h9a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H3a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h9"></path><line x1="16" y1="16" x2="16" y2="10"></line><line x1="19" y1="13" x2="13" y2="13"></line></svg>
                                        </label>
                                        <input type="file" id="profile-picture-input" class="hidden" accept="image/*">
                                    </div>
                                    <div id="upload-progress-container" class="w-full max-w-xs hidden">
                                        <progress id="upload-progress" value="0" max="100" class="w-full"></progress>
                                    </div>
                                </div>
                                <div>
                                    <label for="profile-fullname" class="block text-sm font-medium text-slate-700 mb-1">Nama Lengkap</label>
                                    <input type="text" id="profile-fullname" class="form-input" placeholder="Masukkan nama lengkap Anda">
                                </div>
                                <div>
                                    <label for="profile-pob" class="block text-sm font-medium text-slate-700 mb-1">Tempat, Tanggal Lahir</label>
                                    <input type="text" id="profile-pob" class="form-input" placeholder="Contoh: Brebes, 17 Agustus 1945">
                                </div>
                                <div class="flex justify-end pt-2">
                                    <button type="submit" id="save-profile-btn" class="btn btn-primary">Simpan Perubahan</button>
                                </div>
                            </form>
                        </div>
                        <div id="menu-lainnya-mobile" class="card p-4 md:hidden">
                        <h2 class="text-xl font-semibold text-slate-800 mb-4">Menu Lainnya</h2>
                        <div class="space-y-1">
                            <a href="#" data-page="materi_belajar" class="block w-full text-left py-3 px-4 rounded-lg text-slate-700 font-medium hover:bg-slate-100 transition-colors">
                                Materi Belajar
                            </a>
                            <a href="#" data-page="analisis_soal" class="block w-full text-left py-3 px-4 rounded-lg text-slate-700 font-medium hover:bg-slate-100 transition-colors">
                                Analisis Butir Soal
                            </a>
                            <a href="#" data-page="daya_serap" class="block w-full text-left py-3 px-4 rounded-lg text-slate-700 font-medium hover:bg-slate-100 transition-colors">
                                Daya Serap
                            </a>
                            <a href="#" data-page="pengayaan" class="block w-full text-left py-3 px-4 rounded-lg text-slate-700 font-medium hover:bg-slate-100 transition-colors">
                                Pengayaan
                            </a>
                            <a href="#" data-page="pengaturan" class="block w-full text-left py-3 px-4 rounded-lg text-slate-700 font-medium hover:bg-slate-100 transition-colors">
                                Pengaturan
                            </a>
                            <a href="#" data-page="tentang" class="block w-full text-left py-3 px-4 rounded-lg text-slate-700 font-medium hover:bg-slate-100 transition-colors">
                                Tentang
                            </a>
                        </div>
                    </div>
                    </div>
                </div>
                <div id="ringkasan-page" class="page hidden">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                        <div class="card p-6 flex items-center space-x-4">
                            <div class="bg-teal-100 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8 text-teal-600"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg></div>
                            <div>
                                <p class="text-sm text-slate-500">Total Siswa</p>
                                <p id="summary-total-siswa" class="text-3xl font-bold">0</p>
                            </div>
                        </div>
                        <div class="card p-6 flex items-center space-x-4">
                            <div class="bg-sky-100 p-3 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8 text-sky-600"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"></path><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"></path><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"></path><path d="M10 6h4"></path><path d="M10 10h4"></path><path d="M10 14h4"></path><path d="M10 18h4"></path></svg></div>
                             <div>
                                <p class="text-sm text-slate-500">Total Kelas</p>
                                <p id="summary-total-kelas" class="text-3xl font-bold">0</p>
                            </div>
                        </div>
                        <div id="mutqin-card" class="card p-6">
                            <p class="text-sm text-slate-500">Skor Penilaian Rata-rata</p>
                        <div id="summary-mutqin-score" class="flex items-center text-2xl md:text-3xl font-bold mt-1">
                            <span id="summary-mutqin-count" class="text-teal-700">0</span>
                            <span class="text-teal-700">%</span>
                        </div>
                        </div>
                    </div>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div class="card p-6 bg-teal-50 border border-teal-200">
                             <p class="text-sm text-teal-800 font-semibold">Materi Baru Bulan Ini</p>
                        <div id="summary-ziyadah-combined" class="flex items-baseline gap-2 text-3xl font-bold text-teal-700">
                            <span id="summary-ziyadah-count">0</span>
                            <span class="text-lg font-medium text-slate-500">
                                <span class="text-slate-500">Entri</span>
                                <span class="text-slate-500">/</span>
                                <span id="summary-ziyadah-trend-container" class="inline-block text-slate-500">
                                    <span id="summary-ziyadah-trend-sign"></span>
                                    <span id="summary-ziyadah-trend-number">0</span>
                                    <span>%</span>
                                </span>
                            </span>
                        </div>
                         </div>
                          <div class="card p-6 bg-sky-50 border border-sky-200">
                             <p class="text-sm text-sky-800 font-semibold">Ulasan Bulan Ini</p>
                            <div id="summary-murajaah-combined" class="flex items-baseline gap-2 text-3xl font-bold text-sky-700">
                                <span id="summary-murajaah-count">0</span>
                                <span class="text-lg font-medium text-slate-500">
                                    <span class="text-slate-500">Entri</span>
                                    <span class="text-slate-500">/</span>
                                    <span id="summary-murajaah-trend-container" class="inline-block text-slate-500">
                                        <span id="summary-murajaah-trend-sign"></span>
                                        <span id="summary-murajaah-trend-number">0</span>
                                        <span>%</span>
                                    </span>
                                </span>
                            </div>
                         </div>
                    </div>
                    <div class="card mt-8 p-4 sm:p-6">
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-4">
                            <h2 class="text-xl font-semibold text-slate-800 whitespace-nowrap">Pencapaian Siswa</h2>
                            <div class="w-full sm:w-auto flex flex-col sm:flex-row gap-2">
                                <input type="text" id="summary-search-student" class="form-input w-full sm:w-auto" placeholder="Cari nama siswa...">
                                <select id="summary-rank-filter-class" class="form-select w-full sm:w-auto"></select>
                            </div>
                        </div>
                        <div id="student-progress-list" class="space-y-2">
                        </div>
                        <div id="pencapaian-pagination-controls" class="flex flex-wrap justify-center items-center gap-2 mt-6">
                    </div>
                </div>
            </div>
<div id="daftar_hadir-page" class="page hidden">
                    <div class="card p-4 sm:p-6">
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-4 gap-4">
                            <h2 class="text-xl font-semibold text-slate-800">Daftar Absensi Siswa</h2>
                            
                            <div class="flex flex-col sm:flex-row sm:items-center gap-2">
                                <select id="hadir-filter-kelas" class="form-select w-full sm:w-auto">
                                    <option value="">Semua Kelas</option>
                                </select>
                                
                                <select id="hadir-filter-bulan" class="form-select w-full sm:w-auto">
                                    </select>
                                
                                <select id="hadir-filter-tahun" class="form-select w-full sm:w-auto">
                                    </select>
                                
                                <button id="add-student-modal-btn" class="btn btn-primary whitespace-nowrap">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-2"><circle cx="11" cy="8" r="4"></circle><path d="M4 20c0-4 4-7 7-7s7 3 7 7"></path><line x1="19" y1="6" x2="19" y2="12"></line><line x1="16" y1="9" x2="22" y2="9"></line></svg>
                                    <span>Tambah Siswa</span>
                                </button>
                            </div>
                        </div>

                        <div id="daftar-hadir-container" class="overflow-x-auto">
                            <p class="text-center text-slate-500 py-4">Pilih kelas untuk menampilkan data absensi.</p>
                        </div>
                    </div>
                </div>
                <div id="jurnal-page" class="page hidden">
                    <div class="max-w-4xl mx-auto space-y-6">
                        <div class="card p-4 sm:p-6">
                            <h2 class="text-xl font-semibold text-slate-800 mb-4">Input Jurnal Mengajar</h2>
                            <form id="jurnal-mengajar-form" class="space-y-4">
                                <input type="hidden" id="jurnal-edit-id" value="">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label for="jurnal-timestamp" class="block text-sm font-medium text-slate-700 mb-1">Hari, Tanggal, Tahun</label>
                                        <input type="datetime-local" id="jurnal-timestamp" class="form-input" required>
                                    </div>
                                    <div>
                                        <label for="jurnal-kelas-select" class="block text-sm font-medium text-slate-700 mb-1">Kelas</label>
                                        <select id="jurnal-kelas-select" class="form-select" required>
                                            <option value="">-- Pilih Kelas --</option>
                                            </select>
                                    </div>
                                </div>
                                <div>
                                    <label for="jurnal-matapelajaran" class="block text-sm font-medium text-slate-700 mb-1">Mata Pelajaran</label>
                                    <input type="text" id="jurnal-matapelajaran" class="form-input" placeholder="Contoh: Fiqih" required>
                                </div>
                                <div>
                                    <label for="jurnal-capaian" class="block text-sm font-medium text-slate-700 mb-1">Capaian Pembelajaran</label>
                                    <textarea id="jurnal-capaian" class="form-input" rows="3" placeholder="Apa yang dipelajari hari ini..."></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-slate-700 mb-1">Absensi Murid</label>
                                    <div id="jurnal-absensi-siswa-container" class="p-3 border rounded-lg bg-slate-50 min-h-[6rem]">
                                        <p id="jurnal-absensi-placeholder" class="text-sm text-slate-400 text-center pt-4">Pilih kelas terlebih dahulu untuk menampilkan daftar siswa.</p>
                                        <div id="jurnal-absensi-siswa-list" class="hidden space-y-2">
                                            </div>
                                    </div>
                                    <textarea id="jurnal-absensi" class="form-input hidden" rows="2"></textarea>
                                </div>
                                <div class="flex justify-end gap-3 pt-2">
                                    <button type="button" id="jurnal-cancel-edit-btn" class="btn btn-secondary hidden">Batal</button>
                                    <button type="submit" id="jurnal-submit-btn" class="btn btn-primary">Simpan Jurnal</button>
                                </div>
                            </form>
                        </div>

                        <div class="card p-4 sm:p-6">
                            <h2 class="text-xl font-semibold text-slate-800 mb-4">Riwayat Jurnal Mengajar</h2>
                            <div id="jurnal-mengajar-list" class="space-y-4">
                                </div>
                            <div id="jurnal-mengajar-pagination" class="flex flex-wrap justify-center items-center gap-2 mt-6"></div>
                        </div>
                    </div>
                </div>

                <div id="riwayat-page" class="page hidden">
                    <div class="card p-4 sm:p-6 max-w-4xl mx-auto">
                        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-4">
                            <h2 class="text-xl font-semibold text-slate-800 whitespace-nowrap">Laporan Jurnal</h2>
                            <div class="w-full sm:w-auto flex flex-col sm:flex-row gap-2">
                                <input type="text" id="riwayat-search-student" class="form-input w-full sm:w-auto" placeholder="Cari nama siswa...">
                                <select id="riwayat-filter-class" class="form-select w-full sm:w-auto"></select>
                            </div>
                        </div>
                        <div id="riwayat-list" class="space-y-3">
                            </div>
                        <div id="riwayat-pagination-controls" class="flex flex-wrap justify-center items-center gap-2 mt-6">
                    </div>
                </div>
                </div>
                
                <div id="kelas-page" class="page hidden">
                    <div class="max-w-4xl mx-auto">
                        <div class="card p-4">
                            <h2 class="text-xl font-semibold mb-4">Daftar Kelas</h2>
                            <form id="add-class-form" class="flex items-center space-x-2 mb-4">
                                <input type="text" id="class-name" class="form-input" placeholder="Buat Kelas Baru..." required>
                                <button type="submit" id="add-class-btn" class="btn btn-primary whitespace-nowrap"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg> <span>Tambah</span></button>
                            </form>
                            <div id="class-list" class="space-y-3">
                                </div>
                        </div>
                    </div>
                </div>

                <div id="detail_siswa-page" class="page hidden">
                    <div class="max-w-4xl mx-auto space-y-6">

                        <div class="card p-6">
                            <h3 class="text-lg font-semibold text-slate-700 mb-3">Jumlah Entri Jurnal (30 Hari Terakhir)</h3>
                            <div id="detail-stats-container" class="grid grid-cols-2 sm:grid-cols-4 gap-4">
                                </div>
                        </div>

                        <div class="card p-6">
                            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-4 gap-3">
                                <h3 class="text-lg font-semibold text-slate-700">Rincian Materi (Per Juz)</h3>
                                <select id="detail-juz-filter" class="form-select w-full sm:w-auto">
                                    </select>
                            </div>
                            
                            <div class="mb-4">
                                <div class="flex justify-between text-sm font-medium text-slate-600 mb-1">
                                    <span id="detail-juz-summary-label">Memuat...</span>
                                    <span id="detail-juz-summary-percentage">0%</span>
                                </div>
                                <div class="w-full bg-slate-200 rounded-full h-2.5">
                                    <div id="detail-juz-summary-bar" class="bg-teal-500 h-2.5 rounded-full transition-all duration-300" style="width: 0%"></div>
                                </div>
                            </div>

                            <div id="detail-juz-surah-list" class="flex flex-wrap gap-2">
                                </div>
                        </div>

                        <div class="card p-6">
                            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-3 gap-3">
                                <h3 class="text-lg font-semibold text-slate-700">Riwayat</h3>
                                <select id="detail-history-filter" class="form-select w-full sm:w-auto">
                                    <option value="setoran">Tampilkan: Riwayat Jurnal</option>
                                    <option value="tes">Tampilkan: Riwayat Ujian</option>
                                </select>
                            </div>
                            
                            <div id="detail-history-list" class="space-y-2 max-h-96 overflow-y-auto pr-2 border rounded-lg p-2 bg-slate-50">
                                </div>
                            <div id="detail-history-pagination" class="flex flex-wrap justify-center items-center gap-2 mt-4">
                                </div>
                        </div>
                        </div></div>

            <div id="uji_kompetensi-page" class="page hidden">
                <div class="max-w-xl mx-auto">    
                <div id="test-step-1-type" class="card p-6">
                    <h2 class="text-xl font-semibold text-slate-800 mb-6">Pengaturan Ujian</h2>
                    <div>
                        <p id="test-student-select-label" class="block text-sm font-medium text-slate-700 mb-2">Pilih satu atau beberapa siswa jika ingin disimpan hasilnya</p>
                        <div id="test-selected-students-list" class="flex flex-wrap gap-2 mb-2"></div>
                        
                        <div id="test-student-search-container">
                            <div class="relative">
                                <input type="text" id="test-student-search-input" class="form-input" placeholder="Ketik nama siswa untuk mencari...">
                                <div id="test-student-search-results" class="absolute z-10 w-full mt-1 bg-white border border-slate-300 rounded-md shadow-lg max-h-60 overflow-y-auto hidden">
                                    </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-8">
                        <h3 class="text-lg font-semibold text-slate-700 mb-2">Pilih Jenis Ujian</h3>
                        <div class="mb-6">
                            <label for="test-type-select" class="block text-sm font-medium text-slate-700 mb-2 sr-only">Jenis Ujian</label>
                            <select id="test-type-select" class="form-select">
                                <option value="continue-verse" selected="">Pilihan Ganda (Lanjutan)</option>
                                <option value="previous-verse">Pilihan Ganda (Sebelumnya)</option>
                                <option value="reorder-verses">Menyusun Kalimat (Beta)</option>
                                <option value="guess-surah">Tebak Konteks</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-6">
                        <label for="test-question-count-select" class="block text-sm font-medium text-slate-700 mb-2">Jumlah Soal</label>
                        <select id="test-question-count-select" class="form-select">
                            <option value="10" selected>10 Soal</option>
                            <option value="20">20 Soal</option>
                            <option value="30">30 Soal</option>
                            <option value="40">40 Soal</option>
                            <option value="50">50 Soal</option>
                        </select>
                    </div>
                    <button id="test-next-step-btn" class="btn btn-primary w-full mt-4">Lanjut</button>
                </div>
                <div id="test-step-2-scope" class="card p-6 hidden">
                    <h2 class="text-xl font-semibold text-slate-800 mb-6">Pilih Lingkup Materi</h2>
                    <div class="space-y-4 mb-6">
                        
                        <div class="space-y-2">
                            <label class="text-sm font-medium text-slate-700">Berdasarkan Surah</label>
                            <div class="grid grid-cols-5 items-center gap-2">
                                <select id="test-surah-select-dari" class="form-select col-span-2"></select>
                                <span class="text-center text-slate-500 text-sm">sampai</span>
                                <select id="test-surah-select-sampai" class="form-select col-span-2"></select>
                            </div>
                        </div>

                        <p class="text-center text-sm text-slate-400">ATAU</p>

                        <div class="space-y-2">
                            <label class="text-sm font-medium text-slate-700">Berdasarkan Juz</label>
                            <div class="grid grid-cols-5 items-center gap-2">
                                <select id="test-juz-select-dari" class="form-select col-span-2"></select>
                                <span class="text-center text-slate-500 text-sm">sampai</span>
                                <select id="test-juz-select-sampai" class="form-select col-span-2"></select>
                            </div>
                        </div>

                    </div>
                    <div class="flex flex-col-reverse sm:flex-row gap-3">
                        <button id="test-back-step-btn" class="btn btn-secondary w-full sm:w-auto">Kembali</button>
                        <button id="start-test-btn" class="btn btn-primary w-full sm:flex-1">Mulai Ujian</button>
                    </div>
                </div>
                <div id="test-progress-view" class="hidden">
                    <div class="card p-6 mb-4">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-semibold text-slate-800">Pertanyaan <span id="current-question-number">1</span>/<span id="total-questions">10</span></h2>
                            <div class="text-lg font-bold">Skor: <span id="current-score">0</span></div>
                        </div>
                        <div id="test-question-container" class="text-center">
                            <p class="text-sm text-slate-500 mb-2" id="question-instruction">Lanjutkan potongan materi berikut:</p>
                            <p id="test-question-text" class="text-2xl font-lateef leading-relaxed text-slate-800 mb-6" dir="rtl">...</p>
                        </div>

                        <div id="test-user-answer-area" class="min-h-[8rem] p-3 border-2 border-dashed border-slate-300 rounded-lg flex flex-wrap gap-2 mb-4 hidden" dir="rtl">
                            </div>
                        <div id="test-answer-options" class="space-y-3">
                            </div>
                        <div id="test-feedback" class="mt-4 text-center font-semibold hidden"></div>
                    </div>
                    <div id="test-controls" class="flex justify-between items-end gap-3">
                        <button id="previous-question-btn" class="btn btn-secondary">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 mr-2"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            <span>Kembali</span>
                        </button>

                        <div class="flex items-end gap-3">
                            <div class="flex flex-col gap-2">
                                <button id="check-reorder-btn" class="btn btn-primary hidden w-full">Periksa Jawaban</button>
                                <button id="end-test-btn" class="btn btn-danger w-full">Akhiri Ujian</button>
                            </div>
                            <button id="next-question-btn" class="btn btn-secondary">
                                <span>Lanjut</span>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 ml-2"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>
                            </button>
                        </div>
                    </div>
                    </div> <div id="test-result-view" class="card p-8 text-center hidden">
                        <h2 class="text-2xl font-bold text-slate-800 mb-2">Ujian Selesai!</h2>
                        <p class="text-slate-600 mb-6">Berikut adalah hasil akhir Anda.</p>
                        <p class="text-5xl font-bold text-teal-600 mb-8" id="final-score">0</p>
                        <button id="restart-test-btn" class="btn btn-primary">Ulangi Ujian</button>
                    </div>

                </div>
            </div>
            
                <div id="bulk-hafalan-modal" class="modal hidden">
                    <div class="card w-full max-w-md p-6">
                        <h2 ...>Input Jurnal Bersama</h2>
                        
                        <div class="mb-4"> <p ...>1. Pilih Siswa</p>
                            <div id="bulk-selected-students-list" ...></div>
                    <div id="bulk-student-search-container" ...>
                        <div class="relative">
                            <input type="text" id="bulk-student-search-input" class="form-input" placeholder="Ketik nama siswa untuk mencari...">
                            <div id="bulk-student-search-results" class="absolute z-10 w-full mt-1 bg-white border border-slate-300 rounded-md shadow-lg max-h-60 overflow-y-auto hidden">
                                </div>
                        </div>
                        </div>
                        </div>
                        <form id="bulk-hafalan-form" class="space-y-4">
                        <p class="block text-sm font-medium text-slate-700 mb-2">2. Masukkan Data Jurnal</p>
                        <div>
                        <label class="block text-sm font-medium mb-1">Tanggal & Waktu Jurnal</label>
                        <input type="datetime-local" id="bulk-hafalan-timestamp" name="hafalan-timestamp" class="form-input" required>
                    </div>
                    <div>
                            <div>
                                <label class="block text-sm font-medium mb-1">Materi (Surah)</label>
                                <select name="surah" id="bulk-surah-select" class="form-select surah-select" required>
                                    </select>
                            </div>

                            <div id="bulk-ayat-inputs-container" class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium mb-1">Detail (Dari)</label>
                                    <select name="ayatDari" id="bulk-ayat-dari-select" class="form-select ayat-dari-select" required></select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-1">Detail (Sampai)</label>
                                    <select name="ayatSampai" id="bulk-ayat-sampai-select" class="form-select ayat-sampai-select" required></select>
                                </div>
                            </div>
                            <div id="bulk-surah-sampai-container" class="hidden">
                                    <label class="block text-sm font-medium mb-1">Sampai Materi</label>
                                    <select name="surahSampai" id="bulk-surah-sampai-select" class="form-select surah-sampai-select" required>
                                    </select>
                                </div>
                            <div>
                                
                            <div>
                                <label class="block text-sm font-medium mb-1">Penilaian</label>
                                <select name="kualitas" id="bulk-kualitas-select" class="form-select">
                                    <option value="sangat-lancar" selected>Sangat Baik</option>
                                    <option value="lancar">Baik</option>
                                    <option value="cukup-lancar">Cukup</option>
                                    <option value="tidak-lancar">Kurang</option>
                                    <option value="sangat-tidak-lancar">Tidak Bisa</option>
                                </select>
                            </div>
                            
                            <div class="flex justify-end space-x-3 pt-4">
                                <button type="button" id="cancel-bulk-hafalan" class="btn btn-secondary">Batal</button>
                                <button type="submit" id="submit-bulk-hafalan" class="btn btn-primary">Simpan untuk Semua</button>
                            </div>
                        </form>
                            <div id="bulk-history-container" class="mb-6 hidden"> <h4 class="text-sm font-semibold text-slate-600 mb-2">Riwayat Terbaru</h4>
                            <div id="bulk-selected-students-history-list" class="space-y-2 max-h-48 overflow-y-auto pr-2 border rounded-lg p-2 bg-slate-50">
                                </div>
                        </div>
                        </div>
                    </div>
                </div>
                </div>
                <div id="pengaturan-page" class="page hidden">
                    <div class="max-w-3xl mx-auto space-y-8">
                        <div class="card p-6">
                            <h2 class="text-xl font-semibold text-slate-800 mb-1">Pengaturan Lingkup Materi</h2>
                             <p class="text-sm text-slate-500 mb-6">Pilih lingkup materi (surah) yang akan ditampilkan pada formulir entri jurnal siswa.</p>
                             <form id="quran-scope-form" class="space-y-4">
                               <div class="grid grid-cols-1 items-center gap-4">
                                    <label for="quran-scope-setting" class="font-medium text-slate-700 sr-only">Pilih Lingkup</label>
                                    <select id="quran-scope-setting" class="form-select">
                                        <option value="full">Al-Qur'an 30 Juz</option>
                                        <option value="juz30">Juz 'Amma (Juz 30)</option>
                                        <option value="pilihan">Surat Pilihan</option>
                                    </select>
                                </div>
                                 <div class="flex justify-end pt-2">
                                    <button type="submit" class="btn btn-primary">Simpan Pengaturan</button>
                                </div>
                            </form>
                        </div>

                        <div id="guru-pin-settings-card" class="card p-6 hidden">
                            <h2 class="text-xl font-semibold text-slate-800 mb-1">Pengaturan PIN Guru</h2>
                            <p class="text-sm text-slate-500 mb-6">Buat atau ubah PIN 6 digit Anda. PIN ini akan digunakan oleh siswa untuk verifikasi.</p>
                            <form id="guru-pin-form" class="space-y-4">
                                <input type="text" name="username" autocomplete="username" style="display: none;">
                                <input type="password" name="password" autocomplete="current-password" style="display: none;">

                                <div class="grid grid-cols-2 items-center gap-4">
                                    <label for="guru-pin-input" class="font-medium text-slate-700">PIN 6 Digit Anda</label>
                                    <div class="relative">
                                        <input type="password" id="guru-pin-input" class="form-input pr-10" placeholder="" required pattern="\d{6}" maxlength="6" autocomplete="one-time-code">
                                        <button type="button" id="toggle-guru-pin" class="absolute inset-y-0 right-0 flex items-center px-3 text-slate-400 hover:text-slate-600 focus:outline-none">
                                            <svg id="guru-pin-eye-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                                            <svg id="guru-pin-eye-off-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 hidden"><path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"></path><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"></path><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"></path><line x1="2" y1="2" x2="22" y2="22"></line></svg>
                                        </button>
                                    </div>
                                </div>
                                <div class="flex justify-end pt-2">
                                    <button type="submit" class="btn btn-primary">Simpan PIN</button>
                                </div>
                            </form>
                        </div>

                        <div id="mutqin-settings-card" class="card p-6">
                            <h2 class="text-xl font-semibold text-slate-800 mb-1">Pengaturan Skor Penilaian</h2>
                            <p class="text-sm text-slate-500 mb-6">Sesuaikan nilai persentase untuk setiap tingkat penilaian. Nilai ini akan digunakan untuk menghitung skor rata-rata.</p>
                            <form id="mutqin-settings-form" class="space-y-4">
                               <div class="grid grid-cols-2 items-center gap-4">
                                    <label for="score-sangat-lancar" class="font-medium text-slate-700">Sangat Baik</label>
                                    <input type="number" id="score-sangat-lancar" class="form-input text-right" min="0" max="100" required>
                                </div>
                                <div class="grid grid-cols-2 items-center gap-4">
                                    <label for="score-lancar" class="font-medium text-slate-700">Baik</label>
                                    <input type="number" id="score-lancar" class="form-input text-right" min="0" max="100" required>
                                </div>
                                <div class="grid grid-cols-2 items-center gap-4">
                                    <label for="score-cukup-lancar" class="font-medium text-slate-700">Cukup</label>
                                    <input type="number" id="score-cukup-lancar" class="form-input text-right" min="0" max="100" required>
                                </div>
                                <div class="grid grid-cols-2 items-center gap-4">
                                    <label for="score-tidak-lancar" class="font-medium text-slate-700">Kurang</label>
                                    <input type="number" id="score-tidak-lancar" class="form-input text-right" min="0" max="100" required>
                                </div>
                                <div class="grid grid-cols-2 items-center gap-4">
                                    <label for="score-sangat-tidak-lancar" class="font-medium text-slate-700">Tidak Bisa</label>
                                    <input type="number" id="score-sangat-tidak-lancar" class="form-input text-right" min="0" max="100" required>
                                </div>
                                <div class="flex justify-end pt-2">
                                    <button type="submit" class="btn btn-primary">Simpan Pengaturan Skor</button>
                                </div>
                            </form>
                        </div>

                        <div class="card p-6">
                            <h2 class="text-xl font-semibold text-slate-800 mb-4">Akun</h2>
                            <p class="text-sm text-slate-500 mb-4">Keluar dari sesi Anda saat ini.</p>
                            <button id="settings-logout-btn" class="btn btn-danger">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
                                <span>Keluar</span>
                            </button>
                        </div>
                    </div>
                </div>
<div id="manajemen_akun-page" class="page hidden">
                    <div class="card p-4 sm:p-6">
                        <div id="akun-main-filter-container" class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-4">
                            <h2 class="text-xl font-semibold text-slate-800 whitespace-nowrap">Daftar Akun</h2>
                            <div class="w-full sm:w-auto flex flex-col sm:flex-row gap-2">
                                <input type="text" id="akun-search" class="form-input w-full sm:w-auto" placeholder="Cari nama atau email...">
                                <select id="akun-filter-role" class="form-select w-full sm:w-auto">
                                    <option value="">Semua Peran</option>
                                    <option value="guru">Guru</option>
                                    <option value="siswa">Siswa</option>
                                </select>
                                <select id="akun-filter-kelas" class="form-select w-full sm:w-auto hidden">
                                <option value="">Semua Kelas</option>
                                </select>
                                <button id="bulk-add-akun-btn" class="btn btn-primary whitespace-nowrap">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 mr-2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                                <span>Tambah Akun</span>
                            </button>
                            </div>
                        </div>
                        <div id="akun-list" class="space-y-3">
                        </div>
                    </div>
                </div> 
                
                <div id="tentang-page" class="page hidden">
                    <div class="card p-6 max-w-3xl mx-auto">
                        <h2 class="text-2xl font-bold text-teal-600 mb-4">Tentang Ruang Madrasah</h2>
                        <div class="space-y-4 text-slate-600">
                            <p>
                                Ruang Madrasah adalah aplikasi jurnal digital yang dirancang khusus untuk membantu para pengajar dalam mencatat, mengelola, dan memantau progres belajar para siswanya secara efisien. Dengan tampilan yang sederhana dan mudah digunakan, Ruang Madrasah memungkinkan guru untuk menyimpan catatan jurnal harian, merekap hasil penilaian, hingga memantau perkembangan setiap siswa dari waktu ke waktu.
                            </p>
                            <p>
                                Selain itu, aplikasi ini juga menyediakan fitur statistik perkembangan yang memudahkan guru dalam melihat pencapaian siswa baik secara individu maupun keseluruhan kelas. Data yang tersimpan rapi dapat dijadikan dasar dalam memberikan bimbingan yang lebih tepat sasaran sesuai kebutuhan masing-masing siswa.
                            </p>
                            <p>
                                Ruang Madrasah hadir sebagai solusi modern dalam mendukung kegiatan belajar-mengajar, menjadikan proses pencatatan lebih praktis, transparan, dan terintegrasi, sehingga guru dapat fokus pada pembinaan, sementara administrasi ditangani secara sistematis oleh aplikasi.
                            </p>
                             <div class="pt-4 mt-4 border-t">
                                <p class="text-sm">
                                    Dikembangkan oleh: <a href="https://wa.me/6285888892326" target="_blank" rel="noopener noreferrer" class="font-bold text-teal-600 hover:underline">Ahmad Zulfikar</a>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="materi_belajar-page" class="page hidden">
                    <div class="card p-6 max-w-3xl mx-auto">
                        <h2 class="text-xl font-semibold text-slate-800 whitespace-nowrap mb-4">Materi Belajar</h2>
                        <p class="text-slate-500">Fitur ini sedang dalam pengembangan.</p>
                    </div>
                </div>
                <div id="analisis_soal-page" class="page hidden">
                    <div class="card p-6 max-w-3xl mx-auto">
                        <h2 class="text-xl font-semibold text-slate-800 whitespace-nowrap mb-4">Analisis Butir Soal</h2>
                        <p class="text-slate-500">Fitur ini sedang dalam pengembangan.</p>
                    </div>
                </div>
                <div id="daya_serap-page" class="page hidden">
                    <div class="card p-6 max-w-3xl mx-auto">
                        <h2 class="text-xl font-semibold text-slate-800 whitespace-nowrap mb-4">Daya Serap</h2>
                        <p class="text-slate-500">Fitur ini sedang dalam pengembangan.</p>
                    </div>
                </div>
                <div id="pengayaan-page" class="page hidden">
                    <div class="card p-6 max-w-3xl mx-auto">
                        <h2 class="text-xl font-semibold text-slate-800 whitespace-nowrap mb-4">Pengayaan</h2>
                        <p class="text-slate-500">Fitur ini sedang dalam pengembangan.</p>
                    </div>
                </div>

        </main>
                <nav id="bottom-nav">
            <a href="#" data-page="ringkasan" class="bottom-nav-link active">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
                <span>Dashboard</span>
            </a>
            <a href="#" data-page="jurnal" class="bottom-nav-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                </svg>
                <span>Jurnal</span>
            </a>
            <a href="#" data-page="daftar_hadir" class="bottom-nav-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="m9 12 2 2 4-4"></path></svg>
                <span>Absensi</span>
            </a>
            <a href="#" data-page="uji_kompetensi" class="bottom-nav-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                <span>Ujian</span>
            </a>
             <a href="#" data-page="profil" class="bottom-nav-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                <span>Profil</span>
            </a>
            
            <a href="#" data-page="manajemen_akun" class="bottom-nav-link hidden" data-role="admin_lembaga">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                <span>Akun</span>
            </a>
            <a href="#" data-page="kelas" class="bottom-nav-link hidden" data-role="admin_lembaga">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"></path><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"></path><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"></path><path d="M10 6h4"></path><path d="M10 10h4"></path><path d="M10 14h4"></path><path d="M10 18h4"></path></svg>
            <span>Kelas</span>
            </a>
            <a href="#" id="admin-logout-bottom" class="bottom-nav-link hidden" data-role="admin_lembaga">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
            <span>Keluar</span> </a>
        </nav>
    <div id="add-student-modal" class="modal hidden">
        <div class="card w-full max-w-md p-6">
            <h2 class="text-2xl font-semibold mb-4">Tambah Siswa</h2>
            
            <div class="mb-6 border-b pb-6">
                 <h3 class="text-lg font-medium mb-2 text-slate-800">Impor Data Siswa</h3>
                 <p class="text-sm text-slate-500 mb-4">Gunakan template untuk menambah banyak siswa sekaligus dari file.</p>
                 <div class="flex flex-col sm:flex-row gap-2">
                     <button type="button" id="download-template-btn" class="btn btn-secondary w-full sm:w-auto">
                         <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                         <span>Unduh Template</span>
                     </button>
                     <input type="file" id="import-file-input" class="hidden" accept=".xlsx, xls">
                     <button type="button" id="import-btn" class="btn btn-primary w-full sm:w-auto">
                         <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                          <span>Impor File</span>
                     </button>
                 </div>
            </div>

            <h3 class="text-lg font-medium mb-4 text-slate-800">Tambah Manual</h3>
            <form id="add-student-form" class="space-y-4">
                <div>
                    <label for="new-student-class" class="block text-sm font-medium text-slate-700 mb-1">Pilih Kelas</label>
                    <select id="new-student-class" class="form-select" required><option value="">-- Pilih Kelas --</option></select>
                </div>
                <div>
                    <label for="new-student-name" class="block text-sm font-medium text-slate-700 mb-1">Nama Siswa</label>
                    <input type="text" id="new-student-name" class="form-input" placeholder="Masukkan nama siswa" required>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" id="cancel-add-student" class="btn btn-secondary">Batal</button>
                    <button type="submit" id="add-student-submit-btn" class="btn btn-primary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><line x1="19" y1="8" x2="19" y2="14"></line><line x1="22" y1="11" x2="16" y2="11"></line></svg> <span>Tambah Siswa</span></button>
                </div>
            </form>
        </div>
    </div>
    <div id="confirm-modal" class="modal hidden">
        <div class="card w-full max-w-sm p-6 text-center">
            <h2 id="confirm-modal-title" class="text-xl font-semibold mb-2">Konfirmasi</h2>
            <p id="confirm-modal-text" class="text-slate-600 mb-6">Apakah Anda yakin?</p>
            <div class="flex justify-center space-x-4">
                <button id="confirm-modal-cancel" class="btn btn-secondary">Batal</button>
                <button id="confirm-modal-ok" class="btn btn-danger">Ya, Hapus</button>
            </div>
        </div>
    </div>
    <div id="add-akun-modal" class="modal hidden">
        <div class="card w-full max-w-md p-6">
            <h2 id="add-akun-modal-title" class="text-2xl font-semibold mb-6">Tambah Akun Baru</h2>
            <form id="add-akun-form" class="space-y-4">
                <input type="hidden" id="akun-edit-id" value="">
                
                <div id="akun-nama-container">
                    <label for="akun-nama" class="block text-sm font-medium text-slate-700 mb-1">Nama Lengkap</label>
                    <input type="text" id="akun-nama" class="form-input" placeholder="Masukkan nama lengkap" required>
                </div>

                <div id="akun-student-select-container" class="hidden">
                    <label for="akun-student-select" class="block text-sm font-medium text-slate-700 mb-1">Pilih Siswa (dari database)</label>
                    <select id="akun-student-select" class="form-select">
                        <option value="">-- Memuat siswa... --</option>
                    </select>
                </div>
                
                <div>
                    <label for="akun-email" class="block text-sm font-medium text-slate-700 mb-1">Email</label>
                    <input type="email" id="akun-email" class="form-input" placeholder="email@contoh.com" required>
                </div>
                
                <div>
                    <label for="akun-role" class="block text-sm font-medium text-slate-700 mb-1">Peran (Role)</label>
                    <select id="akun-role" class="form-select" required>
                        <option value="guru">Guru</option>
                        <option value="siswa">Siswa</option>
                    </select>
                </div>
                
                <div id="akun-password-container">
                    <label for="akun-password" class="block text-sm font-medium text-slate-700 mb-1">Password Baru</label>
                    <div class="relative">
                        <input type="password" id="akun-password" class="form-input pr-10" placeholder="Min. 6 karakter" required autocomplete="new-password">
                        <button type="button" id="toggle-akun-password" class="absolute inset-y-0 right-0 flex items-center px-3 text-slate-400 hover:text-slate-600 focus:outline-none">
                            <svg id="akun-eye-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                            <svg id="akun-eye-off-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 hidden"><path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"></path><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"></path><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"></path><line x1="2" y1="2" x2="22" y2="22"></line></svg>
                        </button>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" id="cancel-add-akun" class="btn btn-secondary">Batal</button>
                    <button type="submit" id="add-akun-submit-btn" class="btn btn-primary">Simpan Akun</button>
                </div>
            </form>
        </div>
    </div>
                <div id="bulk-add-akun-modal" class="modal hidden">
                    <div class="card w-full max-w-lg p-6">
                        <h2 class="text-2xl font-semibold mb-4">Tambah Akun(Maks. 100)</h2>
                        <form id="bulk-add-akun-form">
                            <div id="bulk-add-input-container">
                                <label for="bulk-akun-csv" class="block text-sm font-medium text-slate-700 mb-1">Data Akun</label>
                                <textarea id="bulk-akun-csv" class="form-input w-full" rows="10" placeholder="Tempel data di sini. Pisahkan dengan koma."></textarea>
                            <p class="text-xs text-slate-500 mt-1">
                                Format: <strong>email,nama,role,password</strong> (pisahkan koma, 1 baris per akun).<br>
                                - <strong>Role 'guru':</strong> Akan membuat akun guru baru dengan nama & password tersebut.<br>
                                - <strong>Role 'siswa':</strong> Akan mencari nama siswa di database (nama harus sama persis) dan menautkannya dengan email & password tersebut.<br>
                                <strong class="text-red-600">Peringatan:</strong> Password minimal 6 karakter. Proses 'siswa' akan GAGAL jika nama tidak ditemukan, salah ketik, atau ada duplikat.
                            </p>
                            </div>

                            <div id="bulk-add-progress-container" class="hidden">
                                <p class="font-semibold mb-2">Sedang memproses... <span id="bulk-progress-counter"></span></p>
                                <div id="bulk-add-progress-log" class="h-64 overflow-y-auto text-sm p-3 rounded-lg border bg-slate-50 space-y-2">
                                    </div>
                            </div>

                            <div class="flex justify-end space-x-3 pt-6">
                                <button type="button" id="cancel-bulk-add-akun" class="btn btn-secondary">Batal</button>
                                <button type="submit" id="submit-bulk-add-akun" class="btn btn-primary">Mulai Proses</button>
                            </div>
                        </form>
                    </div>
                </div>
    <div id="profile-setup-modal" class="modal hidden">
    <div class="card w-full max-w-md p-6">
        <h2 class="text-2xl font-semibold mb-2">Lengkapi Profil Anda</h2>
        <p class="text-slate-600 mb-6">Untuk melanjutkan, silakan lengkapi data diri Anda di bawah ini.</p>
        <form id="profile-setup-form" class="space-y-4">
            <div>
                <label for="setup-nama-lengkap" class="block text-sm font-medium text-slate-700 mb-1">Nama Lengkap</label>
                <input type="text" id="setup-nama-lengkap" class="form-input" placeholder="Masukkan nama lengkap Anda" required>
            </div>
            <div>
                <label for="setup-ttl" class="block text-sm font-medium text-slate-700 mb-1">Tempat, Tanggal Lahir</label>
                <input type="text" id="setup-ttl" class="form-input" placeholder="Contoh: Brebes, 17 Agustus 1945" required>
            </div>
            <div id="setup-pin-container" class="hidden">
                <label for="setup-pin" class="block text-sm font-medium text-slate-700 mb-1">Buat PIN 6 Digit</label>
                <div class="relative">
                    <input type="password" id="setup-pin" class="form-input pr-10" placeholder="Masukkan 6 digit angka" pattern="\d{6}" maxlength="6" autocomplete="one-time-code">
                    <button type="button" id="toggle-setup-pin" class="absolute inset-y-0 right-0 flex items-center px-3 text-slate-400 hover:text-slate-600 focus:outline-none">
                        <svg id="setup-pin-eye-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                        <svg id="setup-pin-eye-off-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 hidden"><path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"></path><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"></path><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"></path><line x1="2" y1="2" x2="22" y2="22"></line></svg>
                    </button>
                </div>
                <p class="text-xs text-slate-500 mt-1">PIN ini akan digunakan siswa untuk verifikasi.</p>
            </div>
            <div class="flex justify-end pt-4">
                <button type="submit" id="profile-setup-submit-btn" class="btn btn-primary w-full">Simpan & Lanjutkan</button>
            </div>
        </form>
    </div>
</div>
    <div id="toast-notification" class="fixed top-5 right-5 text-white py-3 px-5 rounded-lg shadow-lg z-50">
        <p id="toast-message"></p>
    </div>

    <script id="manifest-json" type="application/json">
    {
    "name": "Ruang Madrasah",
    "short_name": "Ruang Madrasah",
    "start_url": "/index.html",
    "display": "standalone",
    "background_color": "#f8fafc",
    "theme_color": "#14b8a6",
    "description": "Jurnal Aktivitas Belajar",
    "icons": [
        {
        "src": "https://placehold.co/192x192/14b8a6/FFFFFF?text=JB",
        "sizes": "192x192",
        "type": "image/png",
        "purpose": "any maskable"
        },
        {
        "src": "https://placehold.co/512x512/14b8a6/FFFFFF?text=JB",
        "sizes": "512x512",
        "type": "image/png",
        "purpose": "any maskable"
        }
    ]
    }
    </script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>
    <script>
        const firebaseConfig = {
        apiKey: "AIzaSyB4zxl2TCsevr7KKfdpIQYE3VRyfr-rLOY",
        authDomain: "hafalanqu-app.firebaseapp.com",
        projectId: "hafalanqu-app",
        storageBucket: "hafalanqu-app.appspot.com", // <-- Perbaiki storageBucket
        messagingSenderId: "1032716870319",
        appId: "1:1032716870319:web:30bd0e7353ae806f676a5a"
        };
  // Inisialisasi Firebase
  firebase.initializeApp(firebaseConfig);
  // Buat koneksi ke Firestore Database
  const db = firebase.firestore();
  const auth = firebase.auth();
  const storage = firebase.storage(); // <-- Inisialisasi Storage
</script>
 <script src="js/app.js?v=1"></script>
</body>
</html>